window.sa_event=window.sa_event||function(){var e=[].slice.call(arguments);window.sa_event.q?window.sa_event.q.push(e):window.sa_event.q=[e]};var searchQuery,summaryInclude=300,fuseOptions={shouldSort:!0,ignoreDiacritics:!0,includeMatches:!0,includeScore:!0,tokenize:!0,location:0,distance:100,minMatchCharLength:3,keys:[{name:"title",weight:.01},{name:"contents",weight:.8},{name:"tags",weight:.14},{name:"categories",weight:.05}]},inputBox=document.getElementById("search-query");inputBox!==null&&(searchQuery=param("q"),searchQuery?(inputBox.value=searchQuery||"",executeSearch(searchQuery,!1)):document.getElementById("search-results").innerHTML='<p class="search-results-empty">Please enter a word or phrase above, or see <a href="/tags/">all tags</a>.</p>');function executeSearch(e){show(document.querySelector(".search-loading")),sa_event("search_event",{query:e}),fetch('https://werdado.github.io/plan-ogolny-gdansk/index.json').then(function(t){if(t.status!==200){console.log("Looks like there was a problem. Status Code: "+t.status);return}t.json().then(function(t){var s=new Fuse(t,fuseOptions),n=s.search(e);console.log("Results length: "+n.length),n.length>0?populateResults(n):document.getElementById("search-results").innerHTML='<p class="search-results-empty">No matches found</p>',hide(document.querySelector(".search-loading"))}).catch(function(e){console.log("Fetch Error :-S",e)})})}function populateResults(e){var t=document.getElementById("search-query").value,n=document.getElementById("search-results"),s=document.getElementById("search-result-template").innerHTML;e.forEach(function(e,o){var r,c=e.item.contents,i="",a=[];a.push(t),i=c.substring(0,summaryInclude*2)+"&hellip;",r=render(s,{key:o,title:e.item.title,link:e.item.permalink,categories:e.item.categories,snippet:i}),n.innerHTML+=r,a.forEach(function(e){var n=new Mark(document.getElementById("summary-"+o));n.mark(e)})})}function render(e,t){for(var n,o,i,a,r=/\$\{\s*isset ([a-zA-Z]*) \s*\}(.*)\$\{\s*end\s*}/g,s=e;(n=r.exec(e))!==null;)t[n[1]]?s=s.replace(n[0],n[2]):s=s.replace(n[0],"");e=s;for(o in t)i="\\$\\{\\s*"+o+"\\s*\\}",a=new RegExp(i,"g"),e=e.replace(a,t[o]);return e}function show(e){e.style.display="block"}function hide(e){e.style.display="none"}function param(e){return decodeURIComponent((location.search.split(e+"=")[1]||"").split("&")[0]).replace(/\+/g," ")}